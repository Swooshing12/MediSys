<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:MediSys.ViewModels"
             x:Class="MediSys.Views.Auth.LoginPage"
             x:DataType="viewmodels:LoginViewModel"
             Shell.NavBarIsVisible="False">

    <ContentPage.Resources>
        <ResourceDictionary>
            <!-- Colores médicos profesionales -->
            <Color x:Key="MedicalBlue">#2E86AB</Color>
            <Color x:Key="MedicalTeal">#A23B72</Color>
            <Color x:Key="MedicalGreen">#F18F01</Color>
            <Color x:Key="MedicalWhite">#FFFFFF</Color>
            <Color x:Key="MedicalGray">#F8F9FA</Color>
            <Color x:Key="MedicalDarkBlue">#1A5A7A</Color>
            <Color x:Key="InputBorder">#E1E8ED</Color>
            <Color x:Key="TextDark">#2C3E50</Color>
            <Color x:Key="TextLight">#7F8C8D</Color>
        </ResourceDictionary>
    </ContentPage.Resources>

    <!-- Background con gradiente médico -->
    <ContentPage.Background>
        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="{StaticResource MedicalBlue}" Offset="0.0" />
            <GradientStop Color="{StaticResource MedicalTeal}" Offset="0.5" />
            <GradientStop Color="{StaticResource MedicalDarkBlue}" Offset="1.0" />
        </LinearGradientBrush>
    </ContentPage.Background>

    <ScrollView>
        <Grid RowDefinitions="Auto,*,Auto" Padding="0" MinimumHeightRequest="800">

            <!-- HEADER MÉDICO -->
            <Grid Grid.Row="0" Padding="40,60,40,20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="80" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!-- Icono Médico -->
                <Border Grid.Row="0" 
                        BackgroundColor="{StaticResource MedicalWhite}"
                        WidthRequest="80"
                        HeightRequest="80"
                        HorizontalOptions="Center">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="40" />
                    </Border.StrokeShape>
                    <Border.Shadow>
                        <Shadow Brush="Black" Opacity="0.3" Radius="15" Offset="0,5" />
                    </Border.Shadow>

                    <Label Text="🏥" 
                           FontSize="40" 
                           HorizontalOptions="Center" 
                           VerticalOptions="Center" />
                </Border>

                <!-- Título Principal -->
                <Label Grid.Row="1"
                       Text="MediSys" 
                       FontSize="34" 
                       FontAttributes="Bold"
                       TextColor="{StaticResource MedicalWhite}"
                       HorizontalOptions="Center"
                       Margin="0,15,0,5" />

                <!-- Subtítulo -->
                <Label Grid.Row="2"
                       Text="Sistema de Gestión Médica" 
                       FontSize="16"
                       TextColor="{StaticResource MedicalWhite}"
                       Opacity="0.9"
                       HorizontalOptions="Center" />

                <!-- Línea decorativa -->
                <BoxView Grid.Row="3"
                         BackgroundColor="{StaticResource MedicalGreen}"
                         HeightRequest="3"
                         WidthRequest="80"
                         HorizontalOptions="Center"
                         Margin="0,15,0,0" />
            </Grid>

            <!-- FORMULARIO DE LOGIN -->
            <Border Grid.Row="1"
                    BackgroundColor="{StaticResource MedicalWhite}"
                    Stroke="Transparent"
                    Margin="20,10,20,20"
                    Padding="30">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="25" />
                </Border.StrokeShape>
                <Border.Shadow>
                    <Shadow Brush="Black" Opacity="0.15" Radius="20" Offset="0,10" />
                </Border.Shadow>

                <StackLayout Spacing="25">

                    <!-- Título del Formulario -->
                    <StackLayout Spacing="8">
                        <Label Text="Bienvenido de vuelta" 
                               FontSize="24" 
                               FontAttributes="Bold"
                               TextColor="{StaticResource TextDark}"
                               HorizontalOptions="Center" />

                        <Label Text="Ingresa tus credenciales para continuar" 
                               FontSize="15"
                               TextColor="{StaticResource TextLight}"
                               HorizontalOptions="Center" />
                    </StackLayout>

                    <!-- Campo Email -->
                    <StackLayout Spacing="8">
                        <Label Text="Correo Electrónico" 
                               FontSize="15" 
                               FontAttributes="Bold"
                               TextColor="{StaticResource TextDark}" />

                        <Border BackgroundColor="{StaticResource MedicalGray}"
                                Stroke="{StaticResource InputBorder}"
                                StrokeThickness="1"
                                Padding="0">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="12" />
                            </Border.StrokeShape>

                            <Grid ColumnDefinitions="50,*" ColumnSpacing="0">
                                <!-- Icono Email -->
                                <Label Grid.Column="0"
                                       Text="📧"
                                       FontSize="18"
                                       VerticalOptions="Center"
                                       HorizontalOptions="Center" />

                                <!-- Campo de entrada -->
                                <Entry Grid.Column="1"
                                       Text="{Binding Correo}"
                                       Placeholder="ejemplo@medisys.com"
                                       Keyboard="Email"
                                       BackgroundColor="Transparent"
                                       TextColor="{StaticResource TextDark}"
                                       PlaceholderColor="{StaticResource TextLight}"
                                       FontSize="16"
                                       Margin="0,12,15,12" />
                            </Grid>
                        </Border>
                    </StackLayout>

                    <!-- Campo Contraseña con Toggle -->
                    <StackLayout Spacing="8">
                        <Label Text="Contraseña" 
                               FontSize="15" 
                               FontAttributes="Bold"
                               TextColor="{StaticResource TextDark}" />

                        <Border BackgroundColor="{StaticResource MedicalGray}"
                                Stroke="{StaticResource InputBorder}"
                                StrokeThickness="1"
                                Padding="0">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="12" />
                            </Border.StrokeShape>

                            <Grid ColumnDefinitions="50,*,50" ColumnSpacing="0">
                                <!-- Icono Contraseña -->
                                <Label Grid.Column="0"
                                       Text="🔒"
                                       FontSize="18"
                                       VerticalOptions="Center"
                                       HorizontalOptions="Center" />

                                <!-- Campo de entrada -->
                                <Entry Grid.Column="1"
                                       Text="{Binding Password}"
                                       Placeholder="Ingresa tu contraseña"
                                       IsPassword="{Binding IsPasswordHidden}"
                                       BackgroundColor="Transparent"
                                       TextColor="{StaticResource TextDark}"
                                       PlaceholderColor="{StaticResource TextLight}"
                                       FontSize="16"
                                       Margin="0,12,0,12" />

                                <!-- Botón Toggle Ver/Ocultar -->
                                <Button Grid.Column="2"
                                        Text="{Binding PasswordToggleIcon}"
                                        Command="{Binding TogglePasswordVisibilityCommand}"
                                        BackgroundColor="Transparent"
                                        TextColor="{StaticResource TextLight}"
                                        FontSize="16"
                                        BorderWidth="0"
                                        Padding="0"
                                        WidthRequest="50"
                                        HeightRequest="48" />
                            </Grid>
                        </Border>
                    </StackLayout>

                    <!-- Mensaje de Error -->
                    <Border IsVisible="{Binding ShowError}"
                            BackgroundColor="#FFEBEE"
                            Stroke="#F44336"
                            StrokeThickness="1"
                            Padding="15">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="8" />
                        </Border.StrokeShape>

                        <StackLayout Orientation="Horizontal" Spacing="10">
                            <Label Text="⚠️" FontSize="16" VerticalOptions="Center" />
                            <Label Text="{Binding ErrorMessage}"
                                   TextColor="#D32F2F"
                                   FontSize="14"
                                   VerticalOptions="Center"
                                   FlexLayout.Grow="1" />
                        </StackLayout>
                    </Border>

                    <!-- Forgot Password -->
                    <Button Text="¿Olvidaste tu contraseña?"
                            Command="{Binding ForgotPasswordCommand}"
                            BackgroundColor="Transparent"
                            TextColor="{StaticResource MedicalBlue}"
                            FontSize="14"
                            FontAttributes="Bold"
                            BorderWidth="0"
                            HorizontalOptions="Center"
                            Padding="10,5" />

                    <!-- Botón Login -->
                    <Button Text="{Binding LoginButtonText}"
                            Command="{Binding LoginCommand}"
                            FontSize="17"
                            FontAttributes="Bold"
                            TextColor="{StaticResource MedicalWhite}"
                            HeightRequest="55"
                            IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBoolConverter}}">

                        <Button.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                <GradientStop Color="{StaticResource MedicalBlue}" Offset="0.0" />
                                <GradientStop Color="{StaticResource MedicalTeal}" Offset="1.0" />
                            </LinearGradientBrush>
                        </Button.Background>

                        <Button.Shadow>
                            <Shadow Brush="{StaticResource MedicalBlue}" 
                                    Opacity="0.4" 
                                    Radius="10" 
                                    Offset="0,5" />
                        </Button.Shadow>
                    </Button>

                    <!-- Loading Indicator -->
                    <ActivityIndicator IsRunning="{Binding IsLoading}"
                                       IsVisible="{Binding IsLoading}"
                                       Color="{StaticResource MedicalBlue}"
                                       HeightRequest="30" />

                </StackLayout>
            </Border>

            <!-- FOOTER -->
            <StackLayout Grid.Row="2" Padding="40,20,40,40" Spacing="10">
                <!-- Información de seguridad -->
                <StackLayout Orientation="Horizontal" 
                             HorizontalOptions="Center" 
                             Spacing="8">
                    <Label Text="🔐" FontSize="14" />
                    <Label Text="Conexión segura SSL"
                           TextColor="{StaticResource MedicalWhite}"
                           Opacity="0.8"
                           FontSize="13" />
                </StackLayout>

                <!-- Copyright -->
                <Label Text="© 2025 MediSys - Sistema de Gestión Médica"
                       TextColor="{StaticResource MedicalWhite}"
                       Opacity="0.7"
                       FontSize="12"
                       HorizontalOptions="Center" />

                <!-- Versión -->
                <Label Text="Versión 1.0.0"
                       TextColor="{StaticResource MedicalWhite}"
                       Opacity="0.5"
                       FontSize="11"
                       HorizontalOptions="Center" />
            </StackLayout>

        </Grid>
    </ScrollView>
</ContentPage>